<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate="consultant_details_title">Consultant Details</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <img src="images/evolve-logo.svg" alt="EVOLVE Logo">
            </div>
            <nav>
                <ul class="nav-links">
                    <li><a href="index.html" data-translate="home">Home</a></li>
                    <li><a href="index.html#about" data-translate="about">About</a></li>
                    <li><a href="index.html#services" data-translate="services">Services</a></li>
                    <li><a href="menu.html" data-translate="menu_title">Menu</a></li>
                     <li><a href="index.html#contact" data-translate="contact">Contact</a></li>
                    <li class="language-switcher">
                        <button id="lang-toggle" class="lang-btn">
                            <span class="lang-text">English</span>
                            <i class="fas fa-globe"></i>
                        </button>
                        <div class="language-dropdown">
                            <a href="#" data-lang="en" class="active">English</a>
                            <a href="#" data-lang="ar">العربية</a>
                        </div>
                    </li>
                </ul>
                <div class="hamburger">
                    <i class="fas fa-bars"></i>
                </div>
            </nav>
        </div>
    </header>
    <main>
        <div class="container">
            <div class="meal-details-card" id="consultant-details-card">
                <!-- Consultant details will be loaded here -->
            </div>
            <a href="consultations.html" class="btn" data-translate="back_to_consultations">Back to Consultants</a>
        </div>
    </main>
    <br/><br/>
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="images/evolve-logo.svg" alt="EVOLVE Logo">
                    <p data-translate="tagline">Redefining Athletic Excellence in Saudi Arabia</p>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/evolve.saudi" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
                <div class="footer-links">
                    <h3 data-translate="quick_links">Quick Links</h3>
                    <ul>
                        <li><a href="index.html#home" data-translate="home">Home</a></li>
                        <li><a href="index.html#about" data-translate="about_us">About Us</a></li>
                        <li><a href="index.html#services" data-translate="services_footer">Services</a></li>
                        <li><a href="index.html#contact" data-translate="contact">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h3 data-translate="services_footer">Services</h3>
                    <ul>
                        <li data-translate="training_programs">Training Programs</li>
                        <li data-translate="nutrition_plans">Nutrition Plans</li>
                        <li data-translate="one_on_one">1-on-1 Coaching</li>
                        <li data-translate="corporate_packages">Corporate Packages</li>
                    </ul>
                </div>
                <div class="footer-hours">
                    <h3 data-translate="opening_hours">Opening Hours</h3>
                    <ul>
                        <li data-translate="monday_friday">Monday - Friday: 6am - 10pm</li>
                        <li data-translate="saturday">Saturday: 8am - 8pm</li>
                        <li data-translate="sunday">Sunday: 8am - 6pm</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; <script>document.write(new Date().getFullYear())</script> EVOLVE. <span data-translate="rights_reserved">All Rights Reserved.</span></p>
            </div>
        </div>
    </footer>
    <script src="translations.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const hamburger = document.querySelector('.hamburger');
        const navLinks = document.querySelector('.nav-links');
        const header = document.querySelector('header');
        const backToTopButton = document.getElementById('back-to-top');
        
        // Function to handle mobile menu
        function handleMobileMenu() {
            // Toggle mobile menu
            if (hamburger && navLinks) {
                hamburger.addEventListener('click', function(e) {
                    e.stopPropagation();
                    navLinks.classList.toggle('active');
                    document.body.style.overflow = navLinks.classList.contains('active') ? 'hidden' : '';
                    
                    // Toggle hamburger icon
                    const icon = this.querySelector('i');
                    if (navLinks.classList.contains('active')) {
                        icon.classList.remove('fa-bars');
                        icon.classList.add('fa-times');
                    } else {
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    }
                });
                
                // Close menu when clicking on a link
                const navItems = document.querySelectorAll('.nav-links a');
                navItems.forEach(item => {
                    item.addEventListener('click', function() {
                        navLinks.classList.remove('active');
                        document.body.style.overflow = '';
                        const icon = hamburger.querySelector('i');
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    });
                });
                
                // Close menu when clicking outside
                document.addEventListener('click', function(e) {
                    if (!navLinks.contains(e.target) && !hamburger.contains(e.target) && navLinks.classList.contains('active')) {
                        navLinks.classList.remove('active');
                        document.body.style.overflow = '';
                        const icon = hamburger.querySelector('i');
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    }
                });
            }
        }
        
        // Back to top functionality
        function setupBackToTop() {
            if (backToTopButton) {
                window.addEventListener('scroll', function() {
                    if (window.scrollY > 300) {
                        backToTopButton.classList.add('show');
                    } else {
                        backToTopButton.classList.remove('show');
                    }
                });
                
                backToTopButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }
        }
        
        // Initialize functions
        handleMobileMenu();
        setupBackToTop();
    });
    
    function getConsultantIdFromUrl() {
        const params = new URLSearchParams(window.location.search);
        return params.get('id');
    }
    function renderConsultant(lang, consultant) {
        const servicesList = consultant.services.map(service => `
            <div class="feature-item">
                <div class="feature-icon">
                    <i class="fas fa-check"></i>
                </div>
                <div class="feature-content">
                    <h4>${service}</h4>
                    <p data-translate="service_description_placeholder">Professional consultation service</p>
                </div>
            </div>
        `).join('');
        
        document.getElementById('consultant-details-card').innerHTML = `
        <div class="meal-details-card">
            <!-- Header with Image -->
            <div class="card-header">
                <img src="${consultant.image}" alt="${consultant.name}" style="max-width: 100%; max-height: 100%; border-radius: 8px;">
            </div>
            
            <!-- Card Body -->
            <div class="card-body">
                <h1 class="card-title">${consultant.name}</h1>
                <p class="card-description">${consultant.description}</p>
                
                <div class="expertise-tag" style="background: rgba(255, 95, 46, 0.1); color: var(--primary-color); display: inline-block; padding: 6px 16px; border-radius: 20px; font-weight: 600; margin-bottom: 1.5rem; font-size: 0.9rem;">
                    ${consultant.title}
                </div>
                
                <h3 style="font-size: 1.5rem; margin: 2rem 0 1.5rem; color: #2d3748; position: relative; padding-bottom: 0.75rem; border-bottom: 1px solid #e2e8f0;">
                    <i class="fas fa-star" style="color: #f6ad55; margin-inline-end: 10px;"></i>
                    <span data-translate="services_offered">Services Offered</span>
                </h3>
                
                <div class="features-list">
                    ${servicesList}
                </div>
            </div>
            
            <!-- Card Footer with Contact Form -->
            <div class="card-footer">
                <h3 style="font-size: 1.5rem; margin-bottom: 1.5rem; color: #2d3748; position: relative; padding-bottom: 0.75rem;">
                    <i class="fas fa-envelope" style="color: var(--primary-color); margin-inline-end: 10px;"></i>
                    <span data-translate="contact_consultant">Contact Consultant</span>
                </h3>
                
                <form id="consult-form" style="background: #f8fafc; padding: 1.5rem; border-radius: 12px;">
                    <div class="form-group" style="margin-bottom: 1.25rem;">
                        <label for="name" style="display: block; margin-bottom: 0.5rem; color: #4a5568; font-weight: 500;" data-translate="name">Name</label>
                        <input type="text" id="name" name="name" required 
                               style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 1rem; transition: all 0.3s ease;"
                               data-translate="name_placeholder" placeholder="Enter your name">
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 1.25rem;">
                        <label for="email" style="display: block; margin-bottom: 0.5rem; color: #4a5568; font-weight: 500;" data-translate="email">Email</label>
                        <input type="email" id="email" name="email" required 
                               style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 1rem; transition: all 0.3s ease;"
                               data-translate="email_placeholder" placeholder="Enter your email">
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 1.5rem;">
                        <label for="phone" style="display: block; margin-bottom: 0.5rem; color: #4a5568; font-weight: 500;" data-translate="phone">Phone</label>
                        <input type="text" id="phone" name="phone" required 
                               style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 1rem; transition: all 0.3s ease;"
                               data-translate="phone_placeholder" placeholder="Enter your phone">
                    </div>
                    
                    <button id="submit-btn" class="btn" type="submit" 
                            style="background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
                                   color: white; border: none; padding: 0.875rem 2rem; border-radius: 8px; 
                                   font-weight: 600; cursor: pointer; width: 100%; font-size: 1rem; 
                                   transition: all 0.3s ease;"
                            data-translate="send_message">
                        Send Message
                    </button>
                    
                    <div id="form-notification" class="form-notification" style="margin-top: 1rem;"></div>
                </form>
            </div>
        
        `;
    }
    function showConsultantNotFound() {
        document.getElementById('consultant-details-card').innerHTML = '<div class="no-meals" data-translate="consultant_not_found">Consultant not found.</div>';
    }
    function fetchConsultantData(lang, consultantId) {
        const file = lang === 'ar' ? 'consultants-ar.json' : 'consultants-en.json';
        fetch(file)
            .then(res => res.json())
            .then(consultants => {
                const consultant = consultants.find(c => String(c.id) === String(consultantId));
                if (consultant) {
                    renderConsultant(lang, consultant);
                    setupForm(consultant.email, lang);
                    applyLanguage(lang);
                } else {
                    showConsultantNotFound();
                    applyLanguage(lang);
                }
            })
            .catch(() => {
                showConsultantNotFound();
                applyLanguage(lang);
            });
    }
    function setupForm(email, lang) {
        const form = document.getElementById('consult-form');
        if (!form) return;
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            const formData = new FormData(form);
            const submitBtn = document.getElementById('submit-btn');
            const notification = document.getElementById('form-notification');
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
            notification.className = 'form-notification sending';
            notification.textContent = translations[lang]["sending"] || "Sending...";
            notification.style.display = "block";
            try {
                const formObject = {};
                formData.forEach((value, key) => {
                    formObject[key] = value;
                });
                formObject._subject = "New Consultation Form Submission";
                const response = await fetch(`https://formsubmit.co/ajax/${email}`, {
                    method: "POST",
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(formObject)
                });
                const result = await response.json();
                if (result.success === "true" || result.success === true) {
                    notification.className = "form-notification success";
                    notification.textContent = translations[lang]["success_message"] || "Message sent successfully!";
                    form.reset();
                } else {
                    notification.className = "form-notification error";
                    notification.textContent = translations[lang]["error_message"] || "Failed to send message. Please try again.";
                }
            } catch (error) {
                notification.className = "form-notification error";
                notification.textContent = translations[lang]["network_error"] || "Network error. Please try again.";
            } finally {
                submitBtn.classList.remove("loading");
                submitBtn.disabled = false;
                if (!notification.classList.contains("error")) {
                    setTimeout(() => {
                        notification.style.opacity = "0";
                        setTimeout(() => {
                            notification.textContent = "";
                            notification.className = "form-notification";
                            notification.style.display = "none";
                            notification.style.opacity = "1";
                        }, 500);
                    }, 5000);
                }
            }
        });
    }
    
    // Language application utility copied from consultations page
    function applyLanguage(lang) {
        document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
        if (lang === 'ar' && !document.getElementById('arabic-font')) {
            const fontLink = document.createElement('link');
            fontLink.id = 'arabic-font';
            fontLink.rel = 'stylesheet';
            fontLink.href = 'https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap';
            document.head.appendChild(fontLink);
        }
        document.querySelectorAll('[data-translate]').forEach(element => {
            const key = element.getAttribute('data-translate');
            if (translations[lang] && typeof translations[lang][key] !== 'undefined') {
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    if (key.includes('placeholder')) {
                        element.placeholder = translations[lang][key];
                    } else {
                        element.value = translations[lang][key];
                    }
                } else {
                    element.innerHTML = translations[lang][key];
                }
            }
        });
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Mobile menu is already initialized in the earlier script
        let currentLang = localStorage.getItem('language') || 'en';
        const consultantId = getConsultantIdFromUrl();
        fetchConsultantData(currentLang, consultantId);
        applyLanguage(currentLang);
        document.querySelectorAll('.language-dropdown a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const lang = this.getAttribute('data-lang');
                currentLang = lang;
                localStorage.setItem('language', lang);
                fetchConsultantData(lang, consultantId);
                applyLanguage(lang);
                document.querySelectorAll('.language-dropdown a').forEach(a => a.classList.remove('active'));
                this.classList.add('active');
                document.querySelector('.lang-text').textContent = lang === 'en' ? 'English' : 'العربية';
            });
        });
    });
    </script>
    <style>
    /* You can add extra styles for consultant details if needed */
    </style>
</body>
</html>
